{
  "kind": "build_request",
  "title": "Make Ask Krishna replies more Krishna-like, conversational, and greeting-aware",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-27",
      "text": "Update the backend `getChatbotResponse(userMessage, mood, sessionHistory)` in `backend/main.mo` so Krishna’s `supportiveMessage` is written as an original, conversational reply that synthesizes Bhagavad Gita teachings instead of directly quoting/pasting verse text or returning a generic canned line, while still returning a valid `ChatbotResponse` shape.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "want the chatbot replies to feel even more Krishna-like and dont just give the verses directly but look at the teachings and make your own suggestions to give answers. also be coversational."
        ]
      },
      "acceptanceCriteria": [
        "For non-greeting user messages, `supportiveMessage` is not a direct copy of `Verse.genZKrishnaInterpretation` and does not wrap it as a quote; it should be a paraphrased, Krishna-voiced guidance message in clear English.",
        "`getChatbotResponse` always returns a `ChatbotResponse` with non-empty `supportiveMessage`, `followUpQuestions` (>= 1), and non-empty `actionStep` even when no verse is selected.",
        "Backend behavior remains deterministic/stable and does not trap on any input string (including empty/whitespace)."
      ]
    },
    {
      "id": "REQ-28",
      "text": "Add greeting/small-talk handling in `backend/main.mo` `getChatbotResponse` so that when the user message is a greeting (e.g., \"Hi\", \"Hello\", \"Hey\"), Krishna replies with a friendly greeting and a follow-up like “How are you doing today?” and keeps the conversation moving with at least one appropriate follow-up question.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "if someone says Hi, Say Hi, How are you doing today? and so on."
        ]
      },
      "acceptanceCriteria": [
        "When `userMessage` is a greeting, `supportiveMessage` starts with a friendly greeting and includes a conversational check-in question (e.g., “How are you doing today?”).",
        "When `userMessage` is a greeting, `followUpQuestions` are small-talk oriented (e.g., feelings check-in, what’s on their mind) and contain at least 1 item.",
        "Greeting handling does not require `selectedVerse` to be present; the response is still valid if `selectedVerse` is null."
      ]
    },
    {
      "id": "REQ-29",
      "text": "Ensure all user-facing chat UI helper text in the chat thread is plain English (no emojis) and consistent with the new conversational tone when no verse is available.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "also be coversational."
        ]
      },
      "acceptanceCriteria": [
        "In `frontend/src/components/chat/ChatThread.tsx`, the \"no verse\" hint text renders as plain English without emojis and remains a single concise sentence.",
        "No other user-facing text changes introduce non-English phrasing or emoji-only indicators in the chat thread."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor with all logic in `backend/main.mo` (no additional backend services).",
    "Do not edit any files under `frontend/src/components/ui` or any other paths listed in `frontend.immutablePaths`.",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Populate or complete Bhagavad Gita chapters/verses dataset (Chapters 1–18) beyond what is necessary to adjust chatbot tone.",
    "Add new authentication methods beyond Internet Identity.",
    "Add real-time messaging (WebSockets) or external AI/LLM integrations."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}